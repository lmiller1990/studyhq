import{_ as F}from"./DPNhhfcq.js";import{_ as L}from"./C4sKyBs4.js";import{_ as O}from"./DLgGgg-T.js";import{_ as P}from"./B-Lxl_Zs.js";import{f as R,k as j,j as D,l as G,r as I,o as s,c as m,h as e,a as p,b as _,d as n,w as C,g as M,i as f,F as V,m as X,n as H,t as $,q as J}from"./D1rtcPht.js";import{u as K}from"./cJH77P2W.js";import{u as B}from"./DfHh9iOs.js";import"./Dk2mhVY2.js";import"./CAZilBRX.js";import"./CKc1U0eb.js";import"./NKDqDbzt.js";import"./DvDH6DOc.js";const Q={key:0,class:"mb-4"},W={class:"text-red-500"},Y={key:0,class:"flex flex-col items-end"},pe=R({__name:"index",async setup(Z){let d,x;const r=j().params.id,{data:i,refresh:N}=([d,x]=D(()=>K(`/api/exams/:${r}`,"$z42zBENaXC")),d=await d,x(),d),h=G(()=>{var l;return(((l=i.value)==null?void 0:l.questions)??[]).map((t,u)=>{var c;return{question:t,answer:((c=i.value)==null?void 0:c.answers[u])||""}})}),o=I(!1);async function S(){o.value=!0,await $fetch("/api/exams/grade",{method:"POST",body:{id:r,questions:h.value.map(({question:l,answer:t})=>({question:l,answer:t??"No answer provided."}))}}),o.value=!1,await J(`/exams/${r}/results`)}async function T(){o.value=!0,await $fetch(`/api/exams/${r}/reset`,{method:"POST"}),o.value=!1,await N()}const{run:w,loading:b}=B(S),{run:g,loading:E}=B(T);return(l,t)=>{var k,v;const u=F,c=L,U=O,A=P;return s(),m(V,null,[(k=e(i))!=null&&k.completed?(s(),m("p",Q,[p("span",W,[_(u,{name:"i-heroicons-exclamation-circle"})]),n(" This exam has already been submitted. "),_(c,{class:"border-bottom border-b-green-400 border-b-2",to:`/exams/${e(r)}/results`},{default:C(()=>[n("Click here")]),_:1},8,["to"]),n(" to see the feedback. "),p("button",{onClick:t[0]||(t[0]=(...a)=>e(g)&&e(g)(...a)),class:"border-bottom border-b-green-400 border-b-2"}," Click here "),n(" to take it again. "),e(E)?(s(),M(u,{key:0,name:"i-heroicons-arrow-path",class:"animate-spin"})):f("",!0)])):f("",!0),p("form",{class:"leading-relaxed",onSubmit:t[1]||(t[1]=H((...a)=>e(w)&&e(w)(...a),["prevent"]))},[(s(!0),m(V,null,X(e(h),(a,q)=>{var y;return s(),m("div",null,[p("label",null,[n($(a.question)+" ",1),_(U,{class:"my-2",placeholder:"Answer...",autoresize:"",modelValue:a.answer,"onUpdate:modelValue":z=>a.answer=z,disabled:!!((y=e(i))!=null&&y.answers[q])||e(o),rows:3},null,8,["modelValue","onUpdate:modelValue","disabled"])])])}),256)),(v=e(i))!=null&&v.completed?f("",!0):(s(),m("div",Y,[_(A,{type:"submit",disabled:e(b)||e(o),loading:e(b)},{default:C(()=>[n($(e(b)?"Grading...":"Submit"),1)]),_:1},8,["disabled","loading"])]))],32)],64)}}});export{pe as default};
